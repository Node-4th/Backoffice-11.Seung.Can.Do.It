generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Users {
  id           Int         @id @default(autoincrement()) @map("userId")
  classId      Int?        @map("classId")
  email        String      @unique @map("email") @db.VarChar(255)
  password     String      @map("password") @db.VarChar(255)
  name         String      @map("name") @db.VarChar(255)
  profileImage String?     @map("profileImage") @db.VarChar(255)
  role         Role
  class        Class?      @relation(fields: [classId], references: [id], onDelete: Cascade)
  projects     Projects[]
  teams        Teams[]
  tasks        Tasks[]
  feedbacks    Feedbacks[]

  @@map("Users")
}

model Class {
  id    Int     @id @default(autoincrement()) @map("classId")
  name  String  @map("name") @db.VarChar(255)
  users Users[]

  @@map("Class")
}

model Teams {
  id        Int         @id @default(autoincrement()) @map("teamId")
  userId    Int         @map("userId")
  name      String      @map("name") @db.VarChar(255)
  tasks     Tasks[]
  users     Users       @relation(fields: [userId], references: [id], onDelete: Cascade)
  TeamInfos TeamInfos[]

  @@map("Teams")
}

model TeamInfos {
  id          Int      @id @default(autoincrement()) @map("teamInfoId")
  teamId      Int      @map("teamId")
  teamName    String   @map("teamName")
  groundRules String   @map("groundRules")
  goals       String   @map("goals")
  content     String   @map("content")
  createdAt   DateTime @default(now()) @map("createdAt")
  updatedAt   DateTime @updatedAt @map("updatedAt")
  teams       Teams    @relation(fields: [teamId], references: [id], onDelete: Cascade)
}

model Projects {
  id        Int      @id @default(autoincrement()) @map("projectId")
  userId    Int      @map("userId")
  title     String   @map("title") @db.VarChar(255)
  deadline  DateTime @map("deadline")
  createdAt DateTime @default(now()) @map("createdAt")
  category  Category
  users     Users    @relation(fields: [userId], references: [id], onDelete: Cascade)
  Tasks     Tasks[]

  @@map("Projects")
}

model Tasks {
  id        Int         @id @default(autoincrement()) @map("taskId")
  userId    Int?        @map("userId")
  teamId    Int?        @map("teamId")
  projectId Int         @map("projectId")
  content   String      @map("content") @db.VarChar(255)
  submitUrl String      @map("submitUrl") @db.VarChar(255)
  createdAt DateTime    @default(now()) @map("createdAt")
  updatedAt DateTime    @updatedAt @map("updatedAt")
  status    Status
  users     Users?      @relation(fields: [userId], references: [id], onDelete: Cascade)
  teams     Teams?      @relation(fields: [teamId], references: [id], onDelete: Cascade)
  projects  Projects    @relation(fields: [projectId], references: [id], onDelete: Cascade)
  Feedbacks Feedbacks[]

  @@map("Tasks")
}

model Feedbacks {
  id        Int      @id @default(autoincrement()) @map("feedbackId")
  taskId    Int      @map("taskId")
  userId    Int      @map("userId")
  title     String   @map("title") @db.VarChar(255)
  content   String   @map("content") @db.VarChar(255)
  rating    Rating
  createdAt DateTime @default(now()) @map("createdAt")
  updatedAt DateTime @updatedAt @map("updatedAt")
  status    Status
  task      Tasks    @relation(fields: [taskId], references: [id], onDelete: Cascade)
  user      Users    @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("Feedbacks")
}

enum Role {
  STUDENT
  TUTOR
  ADMIN
}

enum Category {
  TIL
  PERSONAL_PROJECT
  TEAM_PROJECT
}

enum Status {
  SUBMIT_REQUESTED
  IN_PROGRESS
  SUBMIT_COMPLETED
}

enum Rating {
  RATING_1
  RATING_2
  RATING_3
  RATING_4
  RATING_5
  RATING_6
  RATING_7
  RATING_8
  RATING_9
  RATING_10
}
